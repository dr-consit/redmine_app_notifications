<% unless notification.issue.nil? %>
<%if !notification.viewed %>
	<a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :issue_id => notification.issue.id, :anchor => "change-#{notification.journal.id}") %>">
		<%= l(:mark_as_seen) %>
	</a>
<% else %>
        <a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :issue_id => notification.issue.id, :anchor => "change-#{notification.journal.id}", :mark_as_unseen => 1) %>">
                <%= l(:mark_as_unseen) %>
        </a>
<% end %>
<h3>
	<%= avatar(journal.user) %>
	<a href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :issue_id => notification.issue.id, :anchor => "change-#{notification.journal.id}") %>" target="_blank">
		<strong><%= l(:text_issue_updated, :id => "##{notification.issue.id} #{notification.issue.subject}", :author => h(journal.user)) %></strong>
	</a>
</h3>

<% if journal.private_notes? %>
  (<%= l(:field_private_notes) %>)
<% end %>

<ul>
<% details_to_strings(notification.journal.visible_details(notification.author)).each do |string| %>
  <li><%= string %></li>
<% end %>
</ul>

<%= textilizable(journal, :notes, :only_path => false) %>
<% end %>


<% unless notification.kbarticle.nil? %>
<%if !notification.viewed %>
	<a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :article_id => notification.kbarticle.id, :anchor => "change-#{notification.kbarticle.id}") %>">
		<%= l(:mark_as_seen) %>
	</a>
<% else %>
        <a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :article_id => notification.kbarticle.id, :anchor => "change-#{notification.kbarticle.id}", :mark_as_unseen => 1) %>">
                <%= l(:mark_as_unseen) %>
        </a>
<% end %>
<h3>
	<%= avatar(kbarticle.author) %>
	<a href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :article_id => notification.kbarticle.id, :anchor => "change-#{notification.kbarticle.id}") %>" target="_blank">
		<strong><%= l(:text_article_updated, :id => "##{notification.kbarticle.id} #{notification.kbarticle.title}", :author => h(kbarticle.author)) %></strong>
	</a>
</h3>

<% end %>


<% unless notification.news.nil? %>
<%if !notification.viewed %>
	<a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :news_id => notification.news.id, :anchor => "change-#{notification.news.id}") %>">
		<%= l(:mark_as_seen) %>
	</a>
<% else %>
        <a class="view-notification" href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :news_id => notification.news.id, :anchor => "change-#{notification.news.id}", :mark_as_unseen => 1) %>">
                <%= l(:mark_as_unseen) %>
        </a>
<% end %>
<h3>
	<%= avatar(journal.user) %>
	<a href="<%= url_for(:controller => 'app_notifications', :action => 'view', :id => notification.id, :news_id => notification.news.id, :anchor => "change-#{notification.news.id}") %>" target="_blank">
		<strong><%= l(:text_news_updated, :id => "##{notification.news.id} #{notification.news.title}", :author => h(journal.user)) %></strong>
	</a>
</h3>

<% end %>
